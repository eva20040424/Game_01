:: StoryCaption
<div id="story-caption-content">

    <div class="time-display-box">
        â³ <<é¡¯ç¤ºæ™‚é–“>>
    </div>
    
    <hr style="border-color: #444; margin: 8px 0;">

    <div id="status-panel" class="status-root">
        
        <div class="panel-control">
            <span class="control-label">ğŸ‘ï¸ å¿ƒçœ¼æ¨¡å¼</span>
            <label class="switch">
                <<checkbox "$enable_ai_status" false true autocheck>>
                <span class="slider"></span>
            </label>
            <<script>>
                $(document).on('change', '#status-panel input[type="checkbox"]', function() {
                    if(this.checked) $('#status-panel').addClass('ai-active');
                    else $('#status-panel').removeClass('ai-active');
                });
                if(State.variables.enable_ai_status) $('#status-panel').addClass('ai-active');
            <</script>>
        </div>

/* ğŸ’  å‹•æ…‹ç©ºé–“æŒ‰éˆ• ğŸ’  */
    <<if tags().includes("éš¨èº«ç©ºé–“")>>
        
        /* ã€æƒ…æ³ Aï¼šèº«è™•éš¨èº«ç©ºé–“å…§ã€‘ -> é¡¯ç¤ºé›¢é–‹æŒ‰éˆ• */
        <<button "ğŸšª è¿”å›ç¾å¯¦">>
            /* è·³è½‰åˆ°è™•ç†è¿”å›é‚è¼¯çš„ç³»çµ±é é¢ */
            <<goto "è¿”å›ç¾å¯¦">>
        <</button>>

    <<else>>

        /* ã€æƒ…æ³ Bï¼šèº«è™•ç¾å¯¦ä¸–ç•Œã€‘ -> é¡¯ç¤ºé€²å…¥æŒ‰éˆ• */
        <<button "ğŸŒŒ é€²å…¥éš¨èº«ç©ºé–“">>
            /* 1. å­˜æª”ï¼šè¨˜éŒ„ç¾åœ¨åœ¨å“ªå€‹åŠ‡æƒ…é»ï¼Œå­˜å…¥è®Šæ•¸ $lastRealWorldPassage */
            <<set $lastRealWorldPassage to passage()>>
            
            /* 2. å‚³é€ï¼šå‰å¾€éš¨èº«ç©ºé–“æ¨ç´ */
            <<goto "ğŸ’ éš¨èº«ç©ºé–“ğŸ’ ">>
        <</button>>

    <</if>>

        <details open>
            <summary>ğŸ’— ç”Ÿç†æ©Ÿèƒ½ç›£æ¸¬</summary>
            
            <div class="tree-row">
                <div class="hard-data">
                    â”œâ”€ ğŸš½ è†€èƒ±ï¼š[<span class="val">$sys_bladder_ml</span>ml] [<span class="status">$sys_bladder_state</span>]
                </div>
                <div class="soft-desc">$ai_desc_bladder</div>
            </div>

            <div class="tree-row">
                <div class="hard-data">
                    â”œâ”€ â›©ï¸ å®®é ¸ï¼š[æ·±åº¦:<span class="val">$sys_womb_depth</span>cm] [<span class="status">$sys_womb_state</span>]
                </div>
                <div class="soft-desc">$ai_desc_womb</div>
            </div>
            
            <div class="tree-row">
                 <div class="hard-data">
                    â””â”€ ğŸ¬ è‚›è…¸ï¼š[ç‹€æ…‹:<span class="status">$sys_anal_state</span>]
                </div>
                 <<if $ai_desc_anal>>
                    <div class="soft-desc">$ai_desc_anal</div>
                 <</if>>
            </div>
        </details>

        <details>
            <summary>ğŸ’ è£å‚™èˆ‡ç‹€æ…‹</summary>
            <div class="tree-row">
                <div class="hard-data">â”œâ”€ ğŸ‘™ å…§è¡£ï¼š[å·²ç ´æ]</div>
            </div>
            <div class="tree-row">
                <div class="hard-data">â””â”€ ğŸ”Œ ç©å…·ï¼š[éœ‡å‹•:é«˜é »]</div>
            </div>
        </details>
    </div>

    <hr style="border-color: #444; margin: 10px 0;">

    <details>
        <summary>ğŸ¤– AI åŒæ­¥æ¥å£</summary>
        <div style="margin-top: 5px; font-size: 0.8em; color: #888;">
            è«‹å°‡ AI å›è¦†è²¼å…¥ä¸‹æ–¹ï¼š
        </div>
        <<textbox "$temp_ai_input" "" autofocus>>
        <<script>>
            $(document).on('input', 'input[name="textbox-temp_ai_input"]', function() {
                var $input = $(this);
                var text = $input.val();
                if (text.includes(":::TWINE_DATA")) {
                    var safeText = text.replace(/"/g, '\\"');
                    $.wiki('<<parse_ai_data "' + safeText + '">>');
                    $input.val("âœ… ç‹€æ…‹å·²åŒæ­¥ï¼");
                    setTimeout(function() { 
                        $input.val(""); 
                        Engine.show(); 
                    }, 1000);
                }
            });
        <</script>>
        <div style="margin-top:5px;">
           <<button "ğŸ“‹ è¤‡è£½ Prompt">>
               <<run navigator.clipboard.writeText(setup.ai_prompt)>>
               <<run alert("æŒ‡ä»¤å·²è¤‡è£½ï¼")>>
           <</button>>
        </div>
    </details>

</div>